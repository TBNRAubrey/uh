LIBS = -lprotobuf
LDFLAGS = -Lprotobuf/install/lib
CFLAGS = -Iprotobuf/install/include

patchpolicy: device_management_backend.pb.o policy_common_definitions.pb.o chrome_device_policy.pb.o patchpolicy.cc
	g++ -std=c++17 -static $^ -o $@ $(CFLAGS) $(LDFLAGS) $(LIBS) 
	strip $@

%.o: %.cc
	g++ $(CFLAGS) $(LDFLAGS) -c $(LIBS) $< -o $@


clean:
	rm *.o patchpolicy
